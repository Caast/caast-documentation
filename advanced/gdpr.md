## How Caast works

When Caast is installed on your website, we need to be able to identify a user uniqueness. You can choose to bypass this, and choose to remove user uniqueness from all statistics generated by Caast.

!> Note that you wont be able to identify if a buyer has watched one of your lives by disabling cookie usage

If you choose to enabled user uniqueness, Caast will store a cookie named `CaastFgpData`, this cookie contain a uniq id string based on the timestamp a user first visit the page coupled to an algorithm generating a uniq identifier. This cookie contain no sensible data and did not store informations concerning the user personnal datas.

Once this cookie has been placed, it will allow us to identify a user when an other page is loaded or when a checkout occured on your site. (more infos on [how to send checkout data](emitter/README.md) to Caast)

## What is collected

When Caast firstly store the cookie, we will send some non-sensible informations about the current user. Those informations can sometimes be unreliable but they are used as statistics informations on our side and are not used to identify a user uniqueness.

| Key        | Informations                                  |
| ---------- | --------------------------------------------- |
| userAgent  | The user agent string for the current browser |
| platform   | The platform of the user's browser            |
| resolution | The resolution of the user's device           |
| timezone   | The timezone of the user                      |
| language   | The browser language of the user              |

> Note that those datas will only be sent one time and be associated with this user uniq id in our database. We won't be able to cross user informations between websites as the uniqueness is generated per site.

Once Caast is initialized, it will start gathering informations based on several events. All those events can be found [here](library/events.md)

You can choose to send custom informations about your user ([how to send custom data](library/methods.md?id=setUser)), but what you are sending is under your responsability. By default Caast is not able to identify and cross data between our informations and your users's database.

If you want to keep your own data on your side but want to retrieve and cross data from Caast, we offer a lots of [emitted events](library/events.md) allowing you to store data on your side wherever and whenever you want.

## Cookie

Caast will drop a cookie named `CaastFgpData` on your site in order to store a unique identifier for the user navigating on your site. Regarding GDPR user approval, you may want Caast to store a cookie only when a user has accepted your Cookie consentment. To perform this, Caast can be loaded with an optionnal parameter.

### Your user has given explicit consentment and Caast is not yet loaded

If your user has already accepted Cookies consentment, you can load Caast by adding `cookiesAccepted=true` in the script call.

```html
<script type="text/javascript">
  (function (c, a, A, s, t, J, S) {
    (c[t] = c[t]), (J = a.createElement(A)), (S = a.getElementsByTagName(A)[0]);
    J.async = 1;
    J.src = s;
    J.id = 'caast_library';
    S.parentNode.insertBefore(J, S);
  })(window, document, 'script', 'https://cdn.caast.tv/caast-latest/caast.js?APP_ID=MY_APP_ID&APP_KEY=MY_APP_KEY&cookiesAccepted=true', 'caast');
</script>
```

### Your user consentment is still in pending state and Caast is not yet loaded

If your user has not yet accepted Cookies consentment, you can load Caast by adding `cookiesAccepted=false` in the script call.

```html
<script type="text/javascript">
  (function (c, a, A, s, t, J, S) {
    (c[t] = c[t]), (J = a.createElement(A)), (S = a.getElementsByTagName(A)[0]);
    J.async = 1;
    J.src = s;
    J.id = 'caast_library';
    S.parentNode.insertBefore(J, S);
  })(window, document, 'script', 'https://cdn.caast.tv/caast-latest/caast.js?APP_ID=MY_APP_ID&APP_KEY=MY_APP_KEY&cookiesAccepted=false', 'caast');
</script>
```

Congratulation, Caast is now loaded and won't store any cookie on your site, but you may want to inform us when a user has accepted your Cookies consentment. To do so, you simply have to execute the following code when the user has given his consent. This code also applied when a user decide to now allow cookies on your site

```javascript
if (window.CaastLoaded && window.caast) {
  window.caast.cookiesAccepted();
}
```

Once this function is executed Caast will be notified that it is now allowed to store the `CaastFgpData` cookie on your site.

### Your user has already given his consent but decide to revoke the cookie policy parameters

There is another case where your user previously granted access to cookies storage but now decide to revoke this access. Luckily Caast also offer you a way to cancel cookie deposit. To do so, you simply have to execute the following code when the user has updated his consent.

```javascript
if (window.CaastLoaded && window.caast) {
  window.caast.cookiesRejected();
}
```

Once this function is executed Caast will be notified that it is now disallowed to store the `CaastFgpData` cookie on your site and will delete it.
